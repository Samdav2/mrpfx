!function (e, r) { YayCurrency_Callback = r.YayCurrency_Callback || {}, yay_currency_data_args = { common_data_args: { yayCurrencySymbolWrapper: "span.woocommerce-Price-currencySymbol", yayCurrencySwitcher: ".yay-currency-single-page-switcher", yayCountryCurrency: ".yay-currency-country-currency-notice-wrapper", yayCurrencyLoading: "yay-currency-cache-loading", yayCurrencyHide: "yay-currency-force-payment-hide", yayCurrencyWidget: ".yay-currency-widget-switcher", yayCurrencyMenu: ".yay-currency-menu-shortcode-switcher", yayCurrencyShortcode: ".yay-currency-shortcode-switcher", yayCurrencyBlock: ".yay-currency-block-switcher", yayCurrencyShortcodePriceHtml: ".yay-currency-shortcode-price-html-wrapper", yayCurrencyShortcodeProductPriceHtml: ".yay-currency-shortcode-product-price-html-wrapper" }, converter_args: { converterWrapper: ".yay-currency-converter-container", converterAmount: ".yay-currency-converter-amount", converterFrom: ".yay-currency-converter-from-currency", converterTo: ".yay-currency-converter-to-currency", converterResultWrapper: ".yay-currency-converter-result-wrapper", converterResultAmount: ".yay-currency-converter-amount-value", converterResultFrom: ".yay-currency-converter-from-currency-code", converterResultValue: ".yay-currency-converter-result-value", converterResultTo: ".yay-currency-converter-to-currency-code" }, caching_data_args: { yayProductId: ".yay-currency-cache-product-id", yayVariationId: ".variations_form", yayDataProductId: "yay_currency-product-id", yayCurrencyMiniCartContents: yay_callback_data.minicart_contents_class, yayCurrencyProduct: ".yay-currency-single-product-switcher" }, switcher_data_args: { activeClass: "active", upwardsClass: "upwards", openClass: "open", selectedClass: "selected", currencySwitcher: ".yay-currency-switcher", currencyFlag: ".yay-currency-flag", currencySelectedFlag: ".yay-currency-flag.selected", customLoader: ".yay-currency-custom-loader", customOption: ".yay-currency-custom-options", customArrow: ".yay-currency-custom-arrow", customOptionArrow: ".yay-currency-custom-option-row", customOptionArrowSelected: ".yay-currency-custom-option-row.selected", selectTrigger: ".yay-currency-custom-select__trigger", selectWrapper: ".yay-currency-custom-select-wrapper", customSelect: ".yay-currency-custom-select", selectedOption: ".yay-currency-custom-select__trigger .yay-currency-selected-option" }, blocks_data_args: { checkout: ".wp-block-woocommerce-checkout[data-block-name='woocommerce/checkout']", totalCheckout: ".wp-block-woocommerce-checkout .wp-block-woocommerce-checkout-order-summary-block .wc-block-components-totals-footer-item", cart: ".wp-block-woocommerce-cart[data-block-name='woocommerce/cart']", totalCart: ".wp-block-woocommerce-cart .wp-block-woocommerce-cart-order-summary-block .wc-block-components-totals-footer-item", payments: { container: ".wc-block-checkout__payment-method#payment-method", options: 'input.wc-block-components-radio-control__input[name="radio-control-wc-payment-method-options"]', localStorageName: "YayCurrencySelectedPaymentMethod", class: { parent: ".wc-block-components-radio-control-accordion-option", labelOption: "label.wc-block-components-radio-control__option" } }, filterPrice: { class: { wrapper: ".wp-block-woocommerce-price-filter", controls: ".wc-block-price-filter__controls", filterSlideInput: '.wp-block-woocommerce-filter-wrapper[data-filter-type="price-filter"] .wc-block-price-slider input', minPriceWrapper: ".wc-block-price-filter__range-input--min", maxPriceWrapper: ".wc-block-price-filter__range-input--max", minPriceInput: "input.wc-block-price-filter__amount--min", maxPriceInput: "input.wc-block-price-filter__amount--max", resetButton: ".wc-block-components-filter-reset-button", progressRange: ".wc-block-price-filter__range-input-progress" } } }, cookies_data_args: { cartBlocks: "yay_cart_blocks_page", checkoutBlocks: "yay_checkout_blocks_page", blocksForceNoticeHtml: "yay_blocks_force_notice", forcePaymentHtml: "yay_fore_payment_notice_html" } }, YayCurrency_Callback.yay_force_payment_data_args = Object.assign({}, yay_currency_data_args.common_data_args, { yayCurrencyForcePaymentNotice: ".yay-currency-checkout-force-payment-notice" }), YayCurrency_Callback.yay_caching_data_args = Object.assign({}, yay_currency_data_args.common_data_args, yay_currency_data_args.caching_data_args); var t = { actions: {}, filters: {} }; YayCurrency_Callback.Helper = { addHook: function (e, r, c) { t[e][r] || (t[e][r] = []), t[e][r].push(c) }, applyFilters: function (e, r) { return t.filters[e] && t.filters[e].forEach(function (e) { r = e(r) }), r }, doAction: function (e, r) { t.actions[e] && t.actions[e].forEach(function (e) { e.apply(null, r) }) }, setCookie: function (e, r, t) { var c = ""; if (t) { var a = new Date; a.setTime(a.getTime() + 864e5 * t), c = "; expires=" + a.toUTCString() } document.cookie = e + "=" + (r || "") + c + "; path=/" }, getCookie: function (e) { let r = e + "=", t = decodeURIComponent(document.cookie).split(";"); for (let c = 0; c < t.length; c++) { let a = t[c]; for (; " " == a.charAt(0);)a = a.substring(1); if (0 == a.indexOf(r)) return a.substring(r.length, a.length) } return "" }, deleteCookie: function (e) { YayCurrency_Callback.Helper.setCookie(e, "", -1) }, getCurrentCurrency: function (e = !1) { e = e || YayCurrency_Callback.Helper.getCookie(r.yayCurrency.cookie_name); let t = !1; return r.yayCurrency.converted_currency && r.yayCurrency.converted_currency.forEach(r => { r.ID === +e && (t = r) }), yayCurrencyHooks.applyFilters("yayCurrencyGetCurrentCurrency", t) }, getCurrencyIDbyCurrencyName: function (e) { let t = !1; return r.yayCurrency.converted_currency && r.yayCurrency.converted_currency.forEach(r => { r.currency === e && (t = r) }), !!t && t.ID }, getRateFeeByCurrency: function (e = !1) { let r = parseFloat((e = e || YayCurrency_Callback.Helper.getCurrentCurrency()).rate); return r = "percentage" === e.fee.type ? parseFloat(e.rate) + parseFloat(e.rate) * (parseFloat(e.fee.value) / 100) : parseFloat(e.rate) + parseFloat(e.fee.value), yayCurrencyHooks.applyFilters("yayCurrencyGetRateFeeByCurrency", r) }, getBlockData: function () { let r = [], t = e(yay_currency_data_args.common_data_args.yayCurrencyBlock); return t.length && t.each(function () { var t = { isBlockID: e(this).data("block-id"), isShowFlag: e(this).data("show-flag"), isShowCurrencyName: e(this).data("show-currency-name"), isShowCurrencySymbol: e(this).data("show-currency-symbol"), isShowCurrencyCode: e(this).data("show-currency-code"), widgetSize: e(this).data("switcher-size") }; r.push(t) }), yayCurrencyHooks.applyFilters("yayCurrencyGetBlockData", r) }, customResponseCommon: function (t) { let c = !1; t.data.widget_content && (c = !0, e(yay_currency_data_args.common_data_args.yayCurrencyWidget).html(t.data.widget_content)), t.data.menu_content && (c = !0, e(yay_currency_data_args.common_data_args.yayCurrencyMenu).html(t.data.menu_content)), t.data.shortcode_content && (c = !0, e(yay_currency_data_args.common_data_args.yayCurrencyShortcode).html(t.data.shortcode_content)), t.data.block_content && (c = !0, e(yay_currency_data_args.common_data_args.yayCurrencyBlock).each(function () { let r = e(this).data("block-id"); r && e(this).html(t.data.block_content[r]) })), t.data.country_notice && e(yay_currency_data_args.common_data_args.yayCountryCurrency).html(t.data.country_notice), t.data.shortcode_price_html && e(yay_currency_data_args.common_data_args.yayCurrencyShortcodePriceHtml).each(function (r, c) { t.data.shortcode_price_html[r] && e(c).html(t.data.shortcode_price_html[r]) }), t.data.shortcode_product_price_html && e(yay_currency_data_args.common_data_args.yayCurrencyShortcodeProductPriceHtml).each(function (r, c) { t.data.shortcode_product_price_html[r] && e(c).html(t.data.shortcode_product_price_html[r]) }), c && e(r).on("load resize scroll", YayCurrency_Callback.Helper.switcherUpwards()), yayCurrencyHooks.doAction("yayCurrencyResponseCommon", [{ response: t }]) }, blockLoading: function (r) { e(r).addClass("processing").block({ message: null, overlayCSS: { background: "#fff", opacity: .6 } }), yayCurrencyHooks.doAction("yayCurrencyCustomBlockLoading", [{ data: r }]) }, unBlockLoading: function (r) { e(r).removeClass("processing").unblock(), yayCurrencyHooks.doAction("yayCurrencyCustomUnBlockLoading", [{ data: r }]) }, switcherUpwards: function () { let t = e(yay_currency_data_args.common_data_args.yayCurrencySwitcher); t.each(function () { let t = e(this).offset().top + e(this).height() - e(r).scrollTop(), c = e(r).height() - e(this).height() - e(this).offset().top + e(r).scrollTop(); c < 250 && t > 250 ? (e(this).find(yay_currency_data_args.switcher_data_args.customOption).addClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.customArrow).addClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.selectTrigger).addClass(yay_currency_data_args.switcher_data_args.upwardsClass)) : (e(this).find(yay_currency_data_args.switcher_data_args.customOption).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.customArrow).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.selectTrigger).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass)) }), yayCurrencyHooks.doAction("yayCurrencyCustomSwitcherDropdown", [{ data: t }]) }, switcherAction: function () { let t = yay_currency_data_args.switcher_data_args; e(document).on("click", t.selectWrapper, function () { e(t.customSelect, this).toggleClass(t.openClass), e("#slide-out-widget-area").find(t.customOption).toggleClass("overflow-fix"), e("[id^=footer]").toggleClass("z-index-fix"), e(t.customSelect, this).parents(".handheld-navigation").toggleClass("overflow-fix") }), e(document).on("click", t.customOptionArrow, function () { let r = e(this).data("value") ? e(this).data("value") : e(this).data("currency-id"), c = e(this).children(t.currencyFlag).data("country_code"); if (YayCurrency_Callback.Helper.refreshCartFragments(), e(t.currencySwitcher).val(r).change(), YayCurrency_Callback.Helper.setCookie(yayCurrency.cookie_switcher_name ?? "yay_currency_do_change_switcher", r, 1), !e(this).hasClass(t.selectedClass)) { let a = e(this).closest(t.customSelect); e(this).parent().find(t.customOptionArrowSelected).removeClass(t.selectedClass), e(this).addClass(t.selectedClass), a.find(t.currencySelectedFlag).css({ background: `url(${yayCurrency.yayCurrencyPluginURL}assets/dist/flags/${c}.svg)` }), a.find(t.selectedOption).text(e(this).text()), a.find(t.customLoader).addClass(t.activeClass), a.find(t.customArrow).hide() } }), r.addEventListener("click", function (e) { let r = document.querySelectorAll(yay_currency_data_args.switcher_data_args.customSelect); r.forEach(r => { r.contains(e.target) || r.classList.remove(yay_currency_data_args.switcher_data_args.openClass) }) }), yayCurrencyHooks.doAction("yayCurrencyCustomSwitcherAction", [{ data: t }]) }, refreshCartFragments: function () { "undefined" != typeof wc_cart_fragments_params && null !== wc_cart_fragments_params && sessionStorage.removeItem(wc_cart_fragments_params.fragment_name), yayCurrencyHooks.doAction("yayCurrencyCustomRefreshCartFragments", []) }, getListDataForcePayment: function () { let r = YayCurrency_Callback.yay_force_payment_data_args, t = { action: "yayCurrency_handle_force_payment_response", blocks: YayCurrency_Callback.Helper.getBlockData(), widget: e(r.yayCurrencyWidget).length, menu: e(r.yayCurrencyMenu).length, shortcode: e(r.yayCurrencyShortcode).length, country_notice: e(r.yayCountryCurrency).length, country_code: yayCurrency.country_code, foce_payment_notice: e(r.yayCurrencyForcePaymentNotice).length, is_cart_page: yayCurrency.cart_page, nonce: yayCurrency.nonce }; if (e(r.yayCurrencyShortcodePriceHtml).length) { let c = []; e(r.yayCurrencyShortcodePriceHtml).each(function (r, t) { c[r] = e(t).data("default-price") }), t.shortcode_default_price = c } if (e(r.yayCurrencyShortcodeProductPriceHtml).length) { let a = []; e(r.yayCurrencyShortcodeProductPriceHtml).each(function (r, t) { a[r] = e(t).data("shortcode-product-id") }), t.shortcode_product_ids = a } return yayCurrencyHooks.applyFilters("yayCurrencyGetDataForcePayment", t) }, customResponseForcePayment: function (r) { if (r.success) { if (YayCurrency_Callback.Helper.customResponseCommon(r), r.data.force_payment_is_dis_checkout_diff_currency ? e(".yay-currency-checkout-notice-force-payment-wrapper").length && e(".yay-currency-checkout-notice-force-payment-wrapper").html(r.data.force_payment_checkout_notice_html) : e(".yay-currency-checkout-notice-force-payment-wrapper").length && e(".yay-currency-checkout-notice-force-payment-wrapper").html(""), "undefined" != r.data.force_payment_notice_html) { let t = YayCurrency_Callback.yay_force_payment_data_args; if (e(t.yayCurrencyForcePaymentNotice).length) { let c = yay_currency_data_args.cookies_data_args.forcePaymentHtml; if ("" == r.data.force_payment_notice_html || r.data.force_payment_checkout_notice_html) { let a = YayCurrency_Callback.Helper.getCookie(c); a ? YayCurrency_Callback.Helper.deleteCookie(c) : e(t.yayCurrencyForcePaymentNotice).remove() } else { let o = r.data.force_payment_notice_html; e(t.yayCurrencyForcePaymentNotice).removeClass(t.yayCurrencyHide), e(t.yayCurrencyForcePaymentNotice).html(o), r.data.reload_page && YayCurrency_Callback.Helper.setCookie(c, o, +yayCurrency.cookie_lifetime_days) } } } YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_switcher_name) && YayCurrency_Callback.Helper.setCookie(yayCurrency.cookie_switcher_name, YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name)), yayCurrencyHooks.doAction("yayCurrencyResponseForcePayment", [{ response: r }]), r.data.reload_page && location.reload() } }, customResponseForceCurrencyByPaymentMethod: function (r) { r.success && (YayCurrency_Callback.Helper.customResponseCommon(r), r.data.force_payment_is_dis_checkout_diff_currency ? e(".yay-currency-checkout-notice-force-payment-wrapper").length && e(".yay-currency-checkout-notice-force-payment-wrapper").html(r.data.force_payment_checkout_notice_html) : e(".yay-currency-checkout-notice-force-payment-wrapper").length && e(".yay-currency-checkout-notice-force-payment-wrapper").html(""), YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_switcher_name) && YayCurrency_Callback.Helper.setCookie(yayCurrency.cookie_switcher_name, YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name)), yayCurrencyHooks.doAction("yayCurrencyResponseForceCurrencyByPaymentMethod", [{ response: r }]), r.data.reload_page && location.reload()) }, forcePaymentCountryCurrency: function (r, t = !1) { e.ajax({ url: yayCurrency.ajaxurl, type: "POST", data: r, beforeSend: function (e) { YayCurrency_Callback.Helper.blockLoading(yay_currency_data_args.common_data_args.yayCurrencySwitcher), YayCurrency_Callback.Helper.blockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents) }, xhrFields: { withCredentials: !0 }, success: function r(c) { YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.common_data_args.yayCurrencySwitcher), YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents), YayCurrency_Callback.Helper.customResponseForcePayment(c), t && (c.data.force_payment_blocks_checkout_notice_html && "" != c.data.force_payment_blocks_checkout_notice_html && (e(yay_currency_data_args.blocks_data_args.checkout).before(c.data.force_payment_blocks_checkout_notice_html), e(".yay-currency-checkout-notice-current-currency").text(c.data.force_payment_blocks_current_currency)), e(document.body).trigger("wc_fragment_refresh"), c.data.force_payment_blocks_cart_subtotal_fallback && YayCurrency_Callback.Helper.reCalculateCartSubtotalBlocksPage(YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name))) }, error: function (e, r, t) { YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.common_data_args.yayCurrencySwitcher), YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents), console.log("Error responseText: ", e.responseText) } }) }, forceCurrencyByPaymentMethodSelected: function (r, t = !1) { e.ajax({ url: yayCurrency.ajaxurl, type: "POST", data: r, beforeSend: function (e) { YayCurrency_Callback.Helper.blockLoading(yay_currency_data_args.blocks_data_args.checkout) }, xhrFields: { withCredentials: !0 }, success: function e(r) { YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.blocks_data_args.checkout), YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents), YayCurrency_Callback.Helper.customResponseForceCurrencyByPaymentMethod(r) }, error: function (e, r, t) { YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.common_data_args.yayCurrencySwitcher), YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents), console.log("Error responseText: ", e.responseText) } }) }, forcePaymentOnCheckoutPage: function (r) { "undefined" != typeof wc_checkout_params && (yayCurrency.force_payment && e(document.body).on("updated_checkout", function (t) { e(document.body).trigger("wc_fragment_refresh"), YayCurrency_Callback.Helper.reRenderHTMLAfterForceCountryCode(r) }), yayCurrency.force_currency ? (e(document.body).on("payment_method_selected", function (r, t) { e(document.body).trigger("update_checkout") }), e(document.body).on("updated_checkout", function (t) { e(document.body).trigger("wc_fragment_refresh"), YayCurrency_Callback.Helper.reRenderHTMLAfterForceCurrencyByPaymentMethod(r) })) : localStorage.getItem(yay_currency_data_args.blocks_data_args.payments.localStorageName) && localStorage.removeItem(yay_currency_data_args.blocks_data_args.payments.localStorageName)) }, forcePaymentOnCartPage: function (r) { yayCurrency.force_payment && "1" === yayCurrency.cart_page && e(document.body).on("updated_cart_totals", function (e) { let t = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name); t !== r && YayCurrency_Callback.Helper.reRenderHTMLAfterForceCountryCode(r) }) }, reRenderHTMLAfterForceCountryCode: function (e, r = !1) { let t = YayCurrency_Callback.Helper.getListDataForcePayment(); t.yay_currency_old = e, r ? t.woocommerce_blocks = "yes" : t.yay_currency_new = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name), YayCurrency_Callback.Helper.forcePaymentCountryCurrency(t, r) }, reRenderHTMLAfterForceCurrencyByPaymentMethod: function (r, t = !1) { var c = e('input[name="payment_method"]:checked').val(); let a = YayCurrency_Callback.Helper.getListDataForcePayment(); a.action = "yayCurrency_handle_force_currency_by_payment_selected_response", a.yay_currency_old = r, a.yay_currency_new = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name), a.payment_method_id = c, YayCurrency_Callback.Helper.forceCurrencyByPaymentMethodSelected(a, t) }, detectAllowCaching: function (e) { return yayCurrencyHooks.applyFilters("yayCurrencyDetectAllowCaching", e) }, getListProductIdsAvailable: function () { let r = [], t = e(yay_currency_data_args.caching_data_args.yayProductId); t.length && t.each(function (t, c) { let a = e(c).data(yay_currency_data_args.caching_data_args.yayDataProductId); a && r.push(a) }); let c = e(yay_currency_data_args.caching_data_args.yayVariationId); return c.length && c.each(function (t, c) { let a = e(c).data("product_variations"); a.length && a.forEach(e => { r.push(e.variation_id) }) }), yayCurrencyHooks.applyFilters("yayCurrencyGetListProductIds", r) }, getListDataCaching: function (t = !1, c = []) { let a = YayCurrency_Callback.yay_caching_data_args, o = { action: t ? "yay_caching_get_price_html" : "yay_caching_generate_currency_switcher_html", blocks: YayCurrency_Callback.Helper.getBlockData(), widget: e(a.yayCurrencyWidget).length, product: e(a.yayCurrencyProduct).length, menu: e(a.yayCurrencyMenu).length, shortcode: e(a.yayCurrencyShortcode).length, country_notice: e(a.yayCountryCurrency).length, ip_address: yay_currency_caching_data.ip_address, cache_compatible: yayCurrency.cache_compatible ?? "0", _nonce: yay_currency_caching_data.nonce }, n = r.location.search, l = new URLSearchParams(n), i = l.get("currency"); if (i && (o.currency_code_param = i), e(a.yayCurrencyShortcodePriceHtml).length) { let s = []; e(a.yayCurrencyShortcodePriceHtml).each(function (r, t) { s[r] = e(t).data("default-price") }), o.shortcode_default_price = s } if (e(a.yayCurrencyShortcodeProductPriceHtml).length) { let y = []; e(a.yayCurrencyShortcodeProductPriceHtml).each(function (r, t) { y[r] = e(t).data("shortcode-product-id") }), o.shortcode_product_ids = y } return t && (o.productIds = c), yayCurrencyHooks.applyFilters("yayCurrencyGetListDataCaching", o) }, resetCachingLoading: function () { let r = [yay_currency_data_args.common_data_args.yayCurrencySwitcher, yay_currency_data_args.common_data_args.yayCountryCurrency, yay_currency_data_args.common_data_args.yayCurrencyShortcodePriceHtml, yay_currency_data_args.common_data_args.yayCurrencyShortcodeProductPriceHtml, yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents]; e.each(r, function (r, t) { e(t).length && e(t).hasClass(yay_currency_data_args.common_data_args.yayCurrencyLoading) && e(t).removeClass(yay_currency_data_args.common_data_args.yayCurrencyLoading) }), yayCurrencyHooks.doAction("yayCurrencyResetCachingLoading", [{ wrapper_args: r }]) }, detectCheckoutBlocks: function () { var r = !1; return e(yay_currency_data_args.blocks_data_args.checkout).length && (r = !0), yayCurrencyHooks.applyFilters("yayCurrencyDetectCheckoutBlocks", r) }, detectCartBlocks: function () { var r = !1; return e(yay_currency_data_args.blocks_data_args.cart).length && (r = !0), yayCurrencyHooks.applyFilters("yayCurrencyDetectCartBlocks", r) }, wooCommerceBlocksForcePayment: function (r) { YayCurrency_Callback.Helper.deleteCookie(yay_currency_data_args.cookies_data_args.cartBlocks), YayCurrency_Callback.Helper.deleteCookie(yay_currency_data_args.cookies_data_args.checkoutBlocks), YayCurrency_Callback.Helper.detectCheckoutBlocks() && (YayCurrency_Callback.Helper.setCookie(yay_currency_data_args.cookies_data_args.checkoutBlocks, "yes", +yayCurrency.cookie_lifetime_days), e(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents).length && "1" !== yayCurrency.checkout_diff_currency && YayCurrency_Callback.Helper.reCalculateCartSubtotalBlocksPage(YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name)), yayCurrency.force_payment && YayCurrency_Callback.Helper.forcePaymentOnCheckoutBlocksPage(r), yayCurrency.force_currency && YayCurrency_Callback.Helper.forceCurrencyByPaymentMethodOnCheckoutBlocksPage(r), yayCurrency.checkout_notice_html && ("" != yayCurrency.checkout_notice_html && e(yay_currency_data_args.blocks_data_args.checkout).before(yayCurrency.checkout_notice_html), YayCurrency_Callback.Helper.reCalculateCartSubtotalBlocksPage(YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name)))), YayCurrency_Callback.Helper.detectCartBlocks() && (YayCurrency_Callback.Helper.setCookie(yay_currency_data_args.cookies_data_args.cartBlocks, "yes", +yayCurrency.cookie_lifetime_days), yayCurrency.force_payment && YayCurrency_Callback.Helper.forcePaymentOnCartBlocksPage(r)), yayCurrencyHooks.doAction("yayCurrencyHandleForcePaymentBlocks", [{ data_args: yay_currency_data_args, oldCurrencyID: r }]) }, detectForcePaymentInitDomChanges: function (e) { r.onload = function () { let r = yayCurrency.total_block_class ?? (yayCurrency.cart_page ? yay_currency_data_args.blocks_data_args.totalCart : yay_currency_data_args.blocks_data_args.totalCheckout); var t = document.querySelector(r); if (t) { var c = function (r, t) { for (var c of r) "characterData" === c.type && YayCurrency_Callback.Helper.reRenderHTMLAfterForceCountryCode(e, !0) }; new MutationObserver(c).observe(t, { characterData: !0, subtree: !0 }) } } }, forcePaymentOnCheckoutBlocksPage: function (e) { YayCurrency_Callback.Helper.detectForcePaymentInitDomChanges(e), YayCurrency_Callback.Helper.detectApplyCurrencyForceCountryCode(e), yayCurrencyHooks.doAction("yayCurrencyHandleForcePaymentBlocksCheckoutPage", [{ data_args: yay_currency_data_args, oldCurrencyID: e }]) }, forcePaymentOnCartBlocksPage: function (e) { YayCurrency_Callback.Helper.detectForcePaymentInitDomChanges(e), yayCurrencyHooks.doAction("yayCurrencyHandleForcePaymentBlocksCartPage", [{ data_args: yay_currency_data_args, oldCurrencyID: e }]) }, reCalculateCartSubtotalBlocksPage: function (r) { e(document.body).on("wc_fragments_refreshed", function () { e.ajax({ url: yayCurrency.ajaxurl, type: "POST", data: { action: "yayCurrency_get_cart_subtotal_blocks", nonce: yayCurrency.nonce, fallback_currency_code: yayCurrency.fallback_currency_code ? yayCurrency.fallback_currency_code : "" }, beforeSend: function (e) { YayCurrency_Callback.Helper.blockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents) }, xhrFields: { withCredentials: !0 }, success: function r(t) { YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents), t.success && t.data.cart_subtotal && e(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents).find(".woocommerce-Price-amount.amount").html(t.data.cart_subtotal), yayCurrencyHooks.doAction("yayCurrencyReCalculateCartSubtotalBlocksPage", [{ response: t }]) }, error: function (e, r, t) { YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.caching_data_args.yayCurrencyMiniCartContents), console.log("Error responseText: ", e.responseText) } }) }) }, detectApplyCurrencyForceCountryCode: function (t) { let c = YayCurrency_Callback.Helper.getCookie(yay_currency_data_args.cookies_data_args.blocksForceNoticeHtml); if (c && (e(yay_currency_data_args.blocks_data_args.checkout).before(c), YayCurrency_Callback.Helper.deleteCookie(yay_currency_data_args.cookies_data_args.blocksForceNoticeHtml)), yayCurrency.currency_code) { let a = yayCurrency.currency_code, o = null; r.yayCurrency.converted_currency.forEach(e => { if (e.currency == a) { o = e; return } }), o && o.ID !== +t && e.ajax({ url: yayCurrency.ajaxurl, type: "POST", data: { action: "yayCurrency_recalculate_apply_currency_from_blocks", nonce: yayCurrency.nonce, currencyID: t, currentCurrency: o }, beforeSend: function (e) { YayCurrency_Callback.Helper.blockLoading(yay_currency_data_args.blocks_data_args.checkout) }, xhrFields: { withCredentials: !0 }, success: function e(r) { r.success ? (r.data.force_payment_notice && YayCurrency_Callback.Helper.setCookie(yay_currency_data_args.cookies_data_args.blocksForceNoticeHtml, r.data.force_payment_notice, +yayCurrency.cookie_lifetime_days), location.reload()) : YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.blocks_data_args.checkout) }, error: function (e, r, t) { YayCurrency_Callback.Helper.unBlockLoading(yay_currency_data_args.blocks_data_args.checkout), console.log("Error responseText: ", e.responseText) } }) } }, getCurrencyIDByMethodSelected: function (e) { let r = yayCurrency.force_currency.force_currency_payment_options; var t = jQuery.grep(r, function (r) { return r.id === e }); if (t.length) { let c = t[0].currency[0]; if (c && "default" !== c) { let a = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(c); if (a && a.ID) { let o = a.paymentMethods; if ("0" == a.status) { let n = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(yayCurrency.fallback_currency_code); n && n.ID && (o = n.paymentMethods) } if (-1 !== o.indexOf("all") || -1 !== o.indexOf(e)) return a.ID } } } return !1 }, selectedPaymentMethodExists: function (r) { if (!r) return !1; let t = e(yay_currency_data_args.blocks_data_args.payments.options + '[value="' + r + '"]'); return !!t.length }, setInitWithPaymentOptionsExists: function (r, t) { let c = localStorage.getItem(yay_currency_data_args.blocks_data_args.payments.localStorageName), a = r.first().val(), o = YayCurrency_Callback.Helper.selectedPaymentMethodExists(c); o && a !== c || (localStorage.setItem(yay_currency_data_args.blocks_data_args.payments.localStorageName, a), c = a); let n = e(yay_currency_data_args.blocks_data_args.payments.options + '[value="' + c + '"]'), l = n.closest(yay_currency_data_args.blocks_data_args.payments.class.parent).find(yay_currency_data_args.blocks_data_args.payments.class.labelOption); l.length && (YayCurrency_Callback.Helper.handleForceCurrencyByPaymentMethod(c, t), l.click()) }, setInitPaymentMethodSelected: function (r) { let t = e(yay_currency_data_args.blocks_data_args.payments.options); if (t.length) YayCurrency_Callback.Helper.setInitWithPaymentOptionsExists(t, r); else if (e(yay_currency_data_args.blocks_data_args.payments.container).length) { let c = 1, a = setInterval(function () { (e(yay_currency_data_args.blocks_data_args.payments.options).length || 3 === c) && ((t = e(yay_currency_data_args.blocks_data_args.payments.options)).length ? (YayCurrency_Callback.Helper.setInitWithPaymentOptionsExists(t, r), clearInterval(a)) : --c), ++c }, 500) } }, paymentMethodSelectedInitCheckoutBlocks: function (e) { let r = !1, t = new MutationObserver(t => { t.forEach(t => { "childList" === t.type && t.addedNodes.forEach(t => { 1 === t.nodeType && "payment-method" === t.id && (r = !0, YayCurrency_Callback.Helper.setInitPaymentMethodSelected(e)) }) }) }); t.observe(document.body, { childList: !0, subtree: !0 }), setTimeout(() => { !r && YayCurrency_Callback.Helper.setInitPaymentMethodSelected(e) }, 500) }, handleChangePaymentMethod: function (r) { e(document).on("change", yay_currency_data_args.blocks_data_args.payments.options, function () { let t = localStorage.getItem(yay_currency_data_args.blocks_data_args.payments.localStorageName), c = e(this).val(); t !== c && (localStorage.setItem(yay_currency_data_args.blocks_data_args.payments.localStorageName, c), YayCurrency_Callback.Helper.handleForceCurrencyByPaymentMethod(c, r)) }) }, handleForceCurrencyByPaymentMethod: function (e, r) { let t = YayCurrency_Callback.Helper.getCurrencyIDByMethodSelected(e); t && t !== +r && (YayCurrency_Callback.Helper.blockLoading(yay_currency_data_args.blocks_data_args.checkout), YayCurrency_Callback.Helper.setCookie(yayCurrency.cookie_switcher_name, t, +yayCurrency.cookie_lifetime_days), YayCurrency_Callback.Helper.setCookie(yayCurrency.cookie_name, t, +yayCurrency.cookie_lifetime_days), location.reload()) }, forceCurrencyByPaymentMethodOnCheckoutBlocksPage: function (e) { YayCurrency_Callback.Helper.paymentMethodSelectedInitCheckoutBlocks(e), YayCurrency_Callback.Helper.handleChangePaymentMethod(e) }, getCurrentCurrencyByCode: function (e = !1, t = !1) { e = e || r.yayCurrency.default_currency_code; let c = !1; return (t = t || r.yayCurrency.converted_currency) && t.forEach(r => { r.currency === e && (c = r) }), c }, currencyConverter: function () { let r = yay_currency_data_args.converter_args.converterWrapper; e(r).length && e(r).each(function (r, t) { YayCurrency_Callback.Helper.doConverterCurrency(e(t)) }) }, doFormatNumber: function (e, r, t, c, a = !1) { var o, n; if ("N/A" === e || "" === e) return e; let l = isFinite(+(e = (e + "").replace(/[^0-9+\-Ee.]/g, ""))) ? +e : 0, i = isFinite(+r) ? Math.abs(r) : 0, s = void 0 === t ? "." : t, y = "", u; return (y = (i ? (o = l, "" + Math.round(o * (u = Math.pow(10, n = i))) / u) : "" + Math.round(l)).split("."))[0].length > 3 && (y[0] = y[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, void 0 === c ? "," : c)), (y[1] || "").length < i && (y[1] = y[1] || "", y[1] += Array(i - y[1].length + 1).join("0")), a ? y.join(s) : y.join(s).replace(/([0-9]*\.0*[1-9]+)0+$/gm, "$1").replace(/.00+$/, "") }, roundedAmountByCurrency: function (e, r) { if (!r) return e; let { numberDecimal: t, decimalSeparator: c, thousandSeparator: a } = r; e = YayCurrency_Callback.Helper.handelRoundedPriceByCurrency(e, r); let o = YayCurrency_Callback.Helper.doFormatNumber(e, Number(t), c, a, !0); return o }, handelRoundedPriceByCurrency: function (e, r) { let { roundingType: t, roundingValue: c, subtractAmount: a } = r; switch (t) { case "up": e = Math.ceil(e / c) * c - a; break; case "down": e = Math.floor(e / c) * c - a; break; case "nearest": e = Math.round(e / c) * c - a }return e }, handelConvertPrice: function (e = 0, r = !1) { if (!r) { let t = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name); r = YayCurrency_Callback.Helper.getCurrentCurrency(t) } let c = parseFloat(YayCurrency_Callback.Helper.getRateFeeByCurrency(r)); return c && 1 !== c ? YayCurrency_Callback.Helper.handelRoundedPriceByCurrency(e * c, r) : e }, handelRevertPrice: function (e = 0, r = !1) { if (!r) { let t = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name); r = YayCurrency_Callback.Helper.getCurrentCurrency(t) } let c = parseFloat(YayCurrency_Callback.Helper.getRateFeeByCurrency(r)); return c && 1 !== c ? e / c : e }, decodeHtmlEntity: function (e) { var r = document.createElement("textarea"); return r.innerHTML = e, r.value }, formatPricePosition: function (e = 0, r = "", t = "left") { let c = e; switch (t) { case "left": c = r + c; break; case "right": c += r; break; case "left_space": c = r + " " + c; break; case "right_space": c = c + " " + r }return c }, formatPriceByCurrency: function (e = 0, r = !1, t = !1) { if (!t) { let c = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name); t = YayCurrency_Callback.Helper.getCurrentCurrency(c) } if (r) { let a = parseFloat(YayCurrency_Callback.Helper.getRateFeeByCurrency(t)); e = YayCurrency_Callback.Helper.handelRoundedPriceByCurrency(e * a, t) } var o = e.toFixed(t.numberDecimal).split("."); o[0] = o[0].replace(/\B(?=(\d{3})+(?!\d))/g, t.thousandSeparator); var n = o.join(t.decimalSeparator), l = YayCurrency_Callback.Helper.decodeHtmlEntity(t.symbol); return n = YayCurrency_Callback.Helper.formatPricePosition(n, l, t.currencyPosition), t.currencyCodePosition && (n = YayCurrency_Callback.Helper.formatPricePosition(n, t.currency, t.currencyCodePosition)), n }, doApplyResultConverter: function (r, t) { let c = r.find(yay_currency_data_args.converter_args.converterFrom), a = r.find(yay_currency_data_args.converter_args.converterTo), o = t.from_currency_code ? t.from_currency_code : e(c).val(), n = t.to_currency_code ? t.to_currency_code : e(a).val(), l = t.amount_value ? +t.amount_value : +e(r.find(yay_currency_data_args.converter_args.converterAmount)).val(); if (n === o) e(r.find(yay_currency_data_args.converter_args.converterResultValue)).text(l); else { let i = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(o), s = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(n), y = YayCurrency_Callback.Helper.getRateFeeByCurrency(s); if (i && o !== yayCurrency.default_currency_code) { let u = YayCurrency_Callback.Helper.getRateFeeByCurrency(i); l *= parseFloat(1 / u) } e(r.find(yay_currency_data_args.converter_args.converterResultValue)).text(YayCurrency_Callback.Helper.roundedAmountByCurrency(l * y, s)) } }, doConverterCurrency: function (r) { let t = r.find(yay_currency_data_args.converter_args.converterAmount), c = r.find(yay_currency_data_args.converter_args.converterFrom), a = r.find(yay_currency_data_args.converter_args.converterTo), o = r.find(yay_currency_data_args.converter_args.converterResultWrapper); e(c).change(function () { e(r.find(yay_currency_data_args.converter_args.converterResultFrom)).text(e(this).val()), YayCurrency_Callback.Helper.doApplyResultConverter(r, { from_currency_code: e(this).val() }) }), e(a).change(function () { e(r.find(yay_currency_data_args.converter_args.converterResultTo)).text(e(this).val()), YayCurrency_Callback.Helper.doApplyResultConverter(r, { to_currency_code: e(this).val() }) }), e(t).on("input", function () { let t = e(this).val(); e(this).val(t.replace(/\D/g, "")), t ? (e(o).show(), e(r.find(yay_currency_data_args.converter_args.converterResultAmount)).text(t), YayCurrency_Callback.Helper.doApplyResultConverter(r, { amount_value: t })) : e(o).hide() }), e(t).trigger("input"), e(c).trigger("change"), e(a).trigger("change") }, handleFilterByPrice: function (e) { r.addEventListener("load", function () { YayCurrency_Callback.Helper.handleFilterByPriceClassicEditor(e), YayCurrency_Callback.Helper.handleFilterByPriceBlock(e) }) }, handleFilterByPriceClassicEditor: function (t) { if (e(".widget_price_filter .price_slider").length) { let c = YayCurrency_Callback.Helper.getCurrentCurrency(t); if (c.currency === r.yayCurrency.default_currency_code) return; let a = e(".price_slider_amount #min_price").val(), o = e(".price_slider_amount #max_price").val(); a && o && (e(document.body).on("price_slider_create price_slider_slide", function (r, t, a) { e(".price_slider_amount span.from").html(YayCurrency_Callback.Helper.formatPriceByCurrency(t, !0, c)), e(".price_slider_amount span.to").html(YayCurrency_Callback.Helper.formatPriceByCurrency(a, !0, c)) }), e(".price_slider_amount span.from").html(YayCurrency_Callback.Helper.formatPriceByCurrency(a, !0, c)), e(".price_slider_amount span.to").html(YayCurrency_Callback.Helper.formatPriceByCurrency(o, !0, c)), yayCurrencyHooks.doAction("yayCurrencyHandleFilterPriceClassicEditor", [{ current_currency_id: t }])) } }, handleFilterByPriceBlock: function (t) { if (!r.wc) return; let c = e(yay_currency_data_args.blocks_data_args.filterPrice.class.wrapper); if (c.length && c.find(yay_currency_data_args.blocks_data_args.filterPrice.class.controls).length) { let a = 1, o = !1, n = setInterval(function () { let r = e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceWrapper), t = e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceWrapper); if (r.length && t.length) { let c = e(yay_currency_data_args.blocks_data_args.filterPrice.class.filterSlideInput).parents(yay_currency_data_args.blocks_data_args.filterPrice.class.controls), l = c.clone(); c.replaceWith(l); let i = !!r.attr("aria-valuetext") && +r.attr("aria-valuetext"); i && (e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(i, !0)), e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceInput).css("pointer-events", "none")); let s = !!t.attr("aria-valuetext") && +t.attr("aria-valuetext"); s && (e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(s, !0)), e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceInput).css("pointer-events", "none")), o = !0 } (5 === a || o) && clearInterval(n), ++a }, 500) } e(document).on("input", yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceWrapper, function () { let r = !!e(this).attr("aria-valuetext") && +e(this).attr("aria-valuetext"); r && e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(r, !0)) }), e(document).on("input", yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceWrapper, function () { let r = !!e(this).attr("aria-valuetext") && +e(this).attr("aria-valuetext"); r && e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(r, !0)) }), yayCurrencyHooks.doAction("yayCurrencyHandleFilterPriceBlock", [{ current_currency_id: t }]) } } }(jQuery, window);